#!/bin/bash

OS=$(python3 readies/bin/platform --os)
ARCH=$(python3 readies/bin/platform --arch)

cd tensorflow/tensorflow/lite/tools/make
bash download_dependencies.sh
if [[ $OS == linux ]]; then
	TARGET=linux
	if [[ $ARCH == x64 ]]; then
		bash build_lib.sh
	elif [[ $ARCH == arm64v8 ]]; then
		bash build_aarch64_lib.sh
	elif [[ $ARCH == arm32v7 ]]; then
		echo "Error: arm32 not supported by TFLite"
		exit 1
	fi
elif [[ $OS == macosx ]]; then
	TARGET=osx
	bash build_lib.sh
fi
